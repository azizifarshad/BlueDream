@model BlueDream.Models.ViewModels.ReviewPageViewModel

<h4 class="mb-3">نظرات کاربران</h4>

<div id="reviewsContainer">
    @await Html.PartialAsync("_ReviewsList", Model)
</div>

<h5 class="mt-4">ثبت نظر جدید</h5>
<form id="reviewForm">
    @Html.AntiForgeryToken()
    <input type="hidden" name="ServiceId" value="@Model.ServiceId" />
    
    <div class="mb-2">
        <label>امتیاز</label>
        <div class="star-rating">
            @for (int i = 1; i <= 5; i++)
            {
                <input type="radio" name="Rating" id="star@i" value="@i" required />
                <label for="star@i" title="@i ستاره">&#9733;</label>
            }
        </div>
    </div>

    <div class="mb-2">
        <label>نظر شما</label>
        <textarea name="Comment" class="form-control" maxlength="500" required></textarea>
    </div>

    <button type="submit" class="btn btn-primary">ارسال نظر</button>
</form>

@section Styles{
    <style>
.star-rating {
    direction: rtl;
    display: inline-block;
}
.star-rating input[type="radio"] {
    display: none;
}
.star-rating label {
    font-size: 1.5rem;
    color: #ddd;
    cursor: pointer;
}
.star-rating input[type="radio"]:checked ~ label,
.star-rating label:hover,
.star-rating label:hover ~ label {
    color: #ffc107;
}
</style>
}

@section Scripts{
    <script>
$(document).ready(function(){
    $('#reviewForm').submit(function(e){
        e.preventDefault();
        var form = $(this);
        var data = form.serialize();
        $.ajax({
            url: '@Url.Action("Create", "Reviews")',
            type: 'POST',
            data: data,
            success: function(result){
                $('#reviewsContainer').html(result);
                form[0].reset();
            },
            error: function(xhr){
                console.log(xhr.responseText);
                alert('مشکلی در ارسال نظر رخ داد: ' + xhr.responseText);
            }
        });
    });
});
</script>
}